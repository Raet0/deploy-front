<main>
  <app-drawer></app-drawer>

  <div class="flex justify-center items-center min-h-screen bg-base-200 text-base-content font-sans transition-colors duration-300">
    <div class="card bg-base-100 p-12 rounded-[40px] w-full max-w-[400px] text-center shadow-xl">

      <h2 class="text-3xl font-bold mb-2 text-base-content">Create First Admin</h2>
      <p class="text-sm text-base-content/60 mb-6">Only allowed once.</p>

      @if (successMessage()) {
      <div role="alert" class="alert alert-success mb-6 p-2 text-sm text-white flex justify-center shadow-lg">
        <span>{{ successMessage() }}</span>
      </div>
      }

      @if (errorMessage()) {
      <div role="alert" class="alert alert-error mb-6 p-2 text-sm text-white flex justify-center shadow-lg">
        <span>{{ errorMessage() }}</span>
      </div>
      }

      @if (loading()) {
      <div class="flex justify-center mb-6">
        <div class="loading loading-spinner loading-md"></div>
      </div>
      }

      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">

        <div class="mb-5 text-left">
          <input formControlName="name"
            class="input w-full p-4 rounded-[50px] bg-base-200 text-base-content placeholder-base-content/50 focus:outline-none focus:ring-2 focus:ring-primary transition-all border-none"
            [class.input-error]="name?.invalid && name?.touched"
            type="text" placeholder="Nombre completo">
        </div>

        <div class="mb-5 text-left">
          <input formControlName="email"
            class="input w-full p-4 rounded-[50px] bg-base-200 text-base-content placeholder-base-content/50 focus:outline-none focus:ring-2 focus:ring-primary transition-all border-none"
            [class.input-error]="email?.invalid && email?.touched"
            type="email" placeholder="Email">
        </div>

        <div class="mb-5 text-left">
          <div class="relative">
            <input formControlName="password"
              class="input w-full p-4 rounded-[50px] bg-base-200 text-base-content placeholder-base-content/50 focus:outline-none focus:ring-2 focus:ring-primary transition-all border-none pr-12"
              [class.input-error]="password?.invalid && password?.touched"
              [type]="showPassword() ? 'text' : 'password'" placeholder="Password">
            <button type="button" (click)="togglePasswordVisibility()" class="absolute right-4 top-1/2 -translate-y-1/2 btn btn-ghost btn-circle btn-sm">
              <i [class]="showPassword() ? 'fa-solid fa-eye-slash' : 'fa-solid fa-eye'"></i>
            </button>
          </div>
        </div>

        <div class="mb-8 text-left">
          <div class="relative">
            <input formControlName="confirmPassword"
              class="input w-full p-4 rounded-[50px] bg-base-200 text-base-content placeholder-base-content/50 focus:outline-none focus:ring-2 focus:ring-primary transition-all border-none pr-12"
              [class.input-error]="confirmPassword?.invalid && confirmPassword?.touched"
              [type]="showConfirmPassword() ? 'text' : 'password'" placeholder="Confirm Password">
            <button type="button" (click)="toggleConfirmPasswordVisibility()" class="absolute right-4 top-1/2 -translate-y-1/2 btn btn-ghost btn-circle btn-sm">
              <i [class]="showConfirmPassword() ? 'fa-solid fa-eye-slash' : 'fa-solid fa-eye'"></i>
            </button>
          </div>
        </div>

        <button type="submit" [disabled]="loading() || registerForm.invalid"
          class="btn w-full py-4 mb-4 rounded-[50px] bg-base-300 text-base-content font-bold tracking-wide uppercase hover:bg-base-content hover:text-base-100 border-none shadow-lg transition-all cursor-pointer h-auto min-h-[3rem] disabled:opacity-70">
          Create Admin
        </button>

      </form>

      <div class="text-sm text-base-content/70">
        <p class="inline">Already have an account? </p>
        <a routerLink="/login" class="link link-primary font-bold no-underline hover:text-primary-focus cursor-pointer">
          Iniciar sesi√≥n
        </a>
      </div>

    </div>
  </div>
</main>
