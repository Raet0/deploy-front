import{b as D,c as g,d as V,e as I,h as T,i as k,j as A,n as B,p as O}from"./chunk-C4LGJKLO.js";import{c as R}from"./chunk-PESOSVUV.js";import{$ as w,B as n,G as _,Ia as G,N as c,O as p,Ra as L,T as f,U as t,V as l,W as s,Xa as h,Ya as N,_ as F,ba as C,ca as x,da as P,ea as S,ga as y,ha as M,ia as d,ja as E,o as m,p as b,q as v,v as u}from"./chunk-TYTM6227.js";var q=["googleBtn"];function z(r,o){if(r&1&&(t(0,"div",4)(1,"span"),d(2),l()()),r&2){let i=C();n(2),E(i.errorMessage())}}function U(r,o){r&1&&s(0,"div",5)}function H(r,o){r&1&&(t(0,"span",9),d(1,"Correo inv\xE1lido"),l())}var j=class r{fb=m(B);authService=m(N);router=m(L);googleBtn;loading=u(!1);errorMessage=u("");showPassword=u(!1);loginForm=this.fb.group({email:["",[g.required,g.email]],password:["",[g.required,g.minLength(6)]]});ngAfterViewInit(){if(!h||h==="TU_GOOGLE_CLIENT_ID"){this.errorMessage.set("Configura GOOGLE_CLIENT_ID en api.config.ts");return}if(typeof google>"u"){this.errorMessage.set("Google SDK no cargado");return}google.accounts.id.initialize({client_id:h,callback:o=>this.handleGoogle(o)}),google.accounts.id.renderButton(this.googleBtn.nativeElement,{theme:"outline",size:"large",width:320})}togglePasswordVisibility(){this.showPassword.set(!this.showPassword())}async login(){if(this.loginForm.invalid){this.loginForm.markAllAsTouched();return}let{email:o,password:i}=this.loginForm.value;this.loading.set(!0),this.errorMessage.set("");try{if(!await this.authService.login(o,i).toPromise()){this.errorMessage.set("Unexpected error while signing in");return}this.router.navigate(["/"])}catch(e){let a=e?.error?.error||"Sign in failed";this.errorMessage.set(a)}finally{this.loading.set(!1)}}async handleGoogle(o){if(!o?.credential){this.errorMessage.set("Google login failed");return}this.loading.set(!0),this.errorMessage.set("");try{if(!await this.authService.loginWithGoogle(o.credential).toPromise()){this.errorMessage.set("Google login failed");return}this.router.navigate(["/"])}catch(i){this.errorMessage.set(i?.error?.error||"Google login failed")}finally{this.loading.set(!1)}}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=_({type:r,selectors:[["app-login-page"]],viewQuery:function(i,e){if(i&1&&x(q,7),i&2){let a;P(a=S())&&(e.googleBtn=a.first)}},decls:23,vars:13,consts:[["googleBtn",""],[1,"flex","justify-center","items-center","min-h-screen","bg-base-200","font-sans","transition-colors","duration-300"],[1,"card","bg-base-100","p-12","rounded-[40px]","w-full","max-w-[400px]","text-center","shadow-xl"],[1,"text-3xl","font-bold","mb-8","text-base-content"],[1,"alert","alert-error","mb-6","p-3","text-sm","text-white","flex","justify-center","shadow-lg","rounded-[20px]"],[1,"loading","loading-spinner","loading-md","mx-auto","mb-6"],[3,"ngSubmit","formGroup"],[1,"mb-5","text-left"],["formControlName","email","type","email","placeholder","Email",1,"input","w-full","p-4","rounded-[50px]","bg-base-200","text-base-content","placeholder-base-content/50","focus:outline-none","focus:ring-2","focus:ring-primary","transition-all","border-none"],[1,"text-error","text-xs","ml-4","mt-1","block"],[1,"mb-8","text-left"],[1,"relative"],["placeholder","Password",1,"input","w-full","p-4","rounded-[50px]","bg-base-200","text-base-content","placeholder-base-content/50","focus:outline-none","focus:ring-2","focus:ring-primary","transition-all","border-none","pr-12",3,"formControlName","type"],["type","button",1,"absolute","right-4","top-1/2","-translate-y-1/2","btn","btn-ghost","btn-circle","btn-sm","hover:bg-base-300",3,"click"],["type","submit",1,"btn","w-full","py-4","mb-4","rounded-[50px]","bg-base-300","text-base-content","font-bold","tracking-wide","uppercase","hover:bg-base-content","hover:text-base-100","border-none","shadow-lg","transition-all","cursor-pointer","h-auto","min-h-[3rem]","disabled:opacity-50",3,"disabled"],[1,"divider","my-4"],[1,"flex","justify-center"]],template:function(i,e){if(i&1){let a=F();t(0,"main"),s(1,"app-drawer"),t(2,"div",1)(3,"div",2)(4,"h2",3),d(5,"Sign In"),l(),c(6,z,3,1,"div",4),c(7,U,1,0,"div",5),t(8,"form",6),w("ngSubmit",function(){return b(a),v(e.login())}),t(9,"div",7),s(10,"input",8),c(11,H,2,0,"span",9),l(),t(12,"div",10)(13,"div",11),s(14,"input",12),t(15,"button",13),w("click",function(){return b(a),v(e.togglePasswordVisibility())}),s(16,"i"),l()()(),t(17,"button",14),d(18," Sign in "),l()(),t(19,"div",15),d(20,"o"),l(),s(21,"div",16,0),l()()()}i&2&&(n(6),p(e.errorMessage()?6:-1),n(),p(e.loading()?7:-1),n(),f("formGroup",e.loginForm),n(2),y("input-error",(e.loginForm.controls.email==null?null:e.loginForm.controls.email.invalid)&&(e.loginForm.controls.email==null?null:e.loginForm.controls.email.touched)),n(),p(e.loginForm.controls.email!=null&&e.loginForm.controls.email.invalid&&(e.loginForm.controls.email!=null&&e.loginForm.controls.email.touched)?11:-1),n(3),y("input-error",(e.loginForm.controls.password==null?null:e.loginForm.controls.password.invalid)&&(e.loginForm.controls.password==null?null:e.loginForm.controls.password.touched)),f("formControlName","password")("type",e.showPassword()?"text":"password"),n(2),M(e.showPassword()?"fa-solid fa-eye-slash":"fa-solid fa-eye text-lg"),n(),f("disabled",e.loginForm.invalid||e.loading()))},dependencies:[O,T,D,V,I,k,A,R,G],encapsulation:2})};export{j as LoginPage};
