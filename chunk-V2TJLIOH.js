import{b as V,c as g,d as I,e as T,h as k,i as A,j as B,n as O,p as R}from"./chunk-C4LGJKLO.js";import{c as j}from"./chunk-UTYNHPED.js";import{$ as w,B as n,G as _,Ia as G,N as c,O as p,Ra as L,Sa as N,T as f,U as i,V as r,W as d,Xa as h,Ya as D,_ as x,ba as C,ca as F,da as S,ea as P,ga as y,ha as M,ia as l,ja as E,o as m,p as b,q as v,v as u}from"./chunk-TYTM6227.js";var z=["googleBtn"];function U(a,o){if(a&1&&(i(0,"div",4)(1,"span"),l(2),r()()),a&2){let t=C();n(2),E(t.errorMessage())}}function H(a,o){a&1&&d(0,"div",5)}function K(a,o){a&1&&(i(0,"span",9),l(1,"Correo inv\xE1lido"),r())}var Q=class a{fb=m(O);authService=m(D);router=m(L);googleBtn;loading=u(!1);errorMessage=u("");showPassword=u(!1);loginForm=this.fb.group({email:["",[g.required,g.email]],password:["",[g.required,g.minLength(6)]]});ngAfterViewInit(){if(!h||h==="TU_GOOGLE_CLIENT_ID"){this.errorMessage.set("Configura GOOGLE_CLIENT_ID en api.config.ts");return}if(typeof google>"u"){this.errorMessage.set("Google SDK no cargado");return}google.accounts.id.initialize({client_id:h,callback:o=>this.handleGoogle(o)}),google.accounts.id.renderButton(this.googleBtn.nativeElement,{theme:"outline",size:"large",width:320})}togglePasswordVisibility(){this.showPassword.set(!this.showPassword())}async login(){if(this.loginForm.invalid){this.loginForm.markAllAsTouched();return}let{email:o,password:t}=this.loginForm.value;this.loading.set(!0),this.errorMessage.set("");try{if(!await this.authService.login(o,t).toPromise()){this.errorMessage.set("Unexpected error while signing in");return}this.router.navigate(["/"])}catch(e){let s=e?.error?.error||"Sign in failed";this.errorMessage.set(s)}finally{this.loading.set(!1)}}async handleGoogle(o){if(!o?.credential){this.errorMessage.set("Google login failed");return}this.loading.set(!0),this.errorMessage.set("");try{if(!await this.authService.loginWithGoogle(o.credential).toPromise()){this.errorMessage.set("Google login failed");return}this.router.navigate(["/"])}catch(t){this.errorMessage.set(t?.error?.error||"Google login failed")}finally{this.loading.set(!1)}}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=_({type:a,selectors:[["app-login-page"]],viewQuery:function(t,e){if(t&1&&F(z,7),t&2){let s;S(s=P())&&(e.googleBtn=s.first)}},decls:28,vars:13,consts:[["googleBtn",""],[1,"flex","justify-center","items-center","min-h-screen","bg-base-200","font-sans","transition-colors","duration-300"],[1,"card","bg-base-100","p-12","rounded-[40px]","w-full","max-w-[400px]","text-center","shadow-xl"],[1,"text-3xl","font-bold","mb-8","text-base-content"],[1,"alert","alert-error","mb-6","p-3","text-sm","text-white","flex","justify-center","shadow-lg","rounded-[20px]"],[1,"loading","loading-spinner","loading-md","mx-auto","mb-6"],[3,"ngSubmit","formGroup"],[1,"mb-5","text-left"],["formControlName","email","type","email","placeholder","Email",1,"input","w-full","p-4","rounded-[50px]","bg-base-200","text-base-content","placeholder-base-content/50","focus:outline-none","focus:ring-2","focus:ring-primary","transition-all","border-none"],[1,"text-error","text-xs","ml-4","mt-1","block"],[1,"mb-8","text-left"],[1,"relative"],["placeholder","Password",1,"input","w-full","p-4","rounded-[50px]","bg-base-200","text-base-content","placeholder-base-content/50","focus:outline-none","focus:ring-2","focus:ring-primary","transition-all","border-none","pr-12",3,"formControlName","type"],["type","button",1,"absolute","right-4","top-1/2","-translate-y-1/2","btn","btn-ghost","btn-circle","btn-sm","hover:bg-base-300",3,"click"],["type","submit",1,"btn","w-full","py-4","mb-4","rounded-[50px]","bg-base-300","text-base-content","font-bold","tracking-wide","uppercase","hover:bg-base-content","hover:text-base-100","border-none","shadow-lg","transition-all","cursor-pointer","h-auto","min-h-[3rem]","disabled:opacity-50",3,"disabled"],[1,"divider","my-4"],[1,"flex","justify-center"],[1,"text-sm","text-base-content/70","mt-6"],[1,"inline"],["routerLink","/register",1,"link","link-primary","font-bold","no-underline","hover:text-primary-focus","cursor-pointer"]],template:function(t,e){if(t&1){let s=x();i(0,"main"),d(1,"app-drawer"),i(2,"div",1)(3,"div",2)(4,"h2",3),l(5,"Sign In"),r(),c(6,U,3,1,"div",4),c(7,H,1,0,"div",5),i(8,"form",6),w("ngSubmit",function(){return b(s),v(e.login())}),i(9,"div",7),d(10,"input",8),c(11,K,2,0,"span",9),r(),i(12,"div",10)(13,"div",11),d(14,"input",12),i(15,"button",13),w("click",function(){return b(s),v(e.togglePasswordVisibility())}),d(16,"i"),r()()(),i(17,"button",14),l(18," Sign in "),r()(),i(19,"div",15),l(20,"o"),r(),d(21,"div",16,0),i(23,"div",17)(24,"p",18),l(25,"No account yet?"),r(),i(26,"a",19),l(27," Create first admin "),r()()()()()}t&2&&(n(6),p(e.errorMessage()?6:-1),n(),p(e.loading()?7:-1),n(),f("formGroup",e.loginForm),n(2),y("input-error",(e.loginForm.controls.email==null?null:e.loginForm.controls.email.invalid)&&(e.loginForm.controls.email==null?null:e.loginForm.controls.email.touched)),n(),p(e.loginForm.controls.email!=null&&e.loginForm.controls.email.invalid&&(e.loginForm.controls.email!=null&&e.loginForm.controls.email.touched)?11:-1),n(3),y("input-error",(e.loginForm.controls.password==null?null:e.loginForm.controls.password.invalid)&&(e.loginForm.controls.password==null?null:e.loginForm.controls.password.touched)),f("formControlName","password")("type",e.showPassword()?"text":"password"),n(2),M(e.showPassword()?"fa-solid fa-eye-slash":"fa-solid fa-eye text-lg"),n(),f("disabled",e.loginForm.invalid||e.loading()))},dependencies:[R,k,V,I,T,A,B,N,j,G],encapsulation:2})};export{Q as LoginPage};
