import{$ as S,Aa as j,B as a,F as Q,Fa as ie,G as A,Ga as re,Ha as ne,Ia as I,K as U,Ka as oe,Ma as $,N as x,O as w,Q as X,R as V,Ra as O,S as H,Sa as ae,T as h,Ta as le,U as o,V as s,W as v,Wa as C,X as u,Y as f,Ya as y,Z as M,_ as b,aa as N,ba as d,ga as Z,i as K,ia as l,ja as E,ka as L,l as D,o as p,p as g,q as _,r as k,s as P,ua as B,v as T,va as ee,wa as te,z as Y}from"./chunk-TYTM6227.js";var q=class i{http=p($);auth=p(y);userProfile=T(null);constructor(){j(()=>{let e=this.auth.currentUser();if(!e){this.userProfile.set(null);return}this.userProfile.set({name:e.name,email:e.email,role:e.role})})}listUsers(e=0,t=50){return this.http.get(`${C}/api/admin/users`,{headers:this.auth.getAuthHeaders(),params:{page:e,size:t}})}createUser(e){return this.http.post(`${C}/api/admin/users`,e,{headers:this.auth.getAuthHeaders()})}updateUser(e,t){return this.http.put(`${C}/api/admin/users/${e}`,t,{headers:this.auth.getAuthHeaders()})}deleteUser(e){return this.http.delete(`${C}/api/admin/users/${e}`,{headers:this.auth.getAuthHeaders()})}getMyProfile(){return this.http.get(`${C}/api/users/me`,{headers:this.auth.getAuthHeaders()}).pipe(K(e=>{let t=this.auth.currentUser();this.userProfile.set({id:e.id,name:e.name,email:e.email,role:t?.role??this.mapRole(e.role),photoUrl:e.photoUrl,headline:e.headline,bio:e.bio,createdAt:e.createdAt})}))}updateMyProfile(e){return this.http.put(`${C}/api/users/me`,e,{headers:this.auth.getAuthHeaders()}).pipe(K(t=>{let r=this.auth.currentUser();this.userProfile.set({id:t.id,name:t.name,email:t.email,role:r?.role??this.mapRole(t.role),photoUrl:t.photoUrl,headline:t.headline,bio:t.bio,createdAt:t.createdAt})}))}currentRole(){return this.userProfile()?.role??null}mapRole(e){switch(e){case"ADMIN":return"admin";case"PROGRAMMER":return"programmer";default:return"user"}}static \u0275fac=function(t){return new(t||i)};static \u0275prov=D({token:i,factory:i.\u0275fac,providedIn:"root"})};var z=class i{THEME_KEY="app-theme";themes=["light","dark","coffee"];saveTheme(e){let t=JSON.stringify(e);localStorage.setItem(this.THEME_KEY,t)}getTheme(){let e=localStorage.getItem(this.THEME_KEY);return e?JSON.parse(e):"dark"}setTheme(e){document.documentElement.setAttribute("data-theme",e),this.saveTheme(e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=D({token:i,factory:i.\u0275fac,providedIn:"root"})};function de(i,e){if(i&1){let t=b();u(0,"li")(1,"button",5),N("click",function(){let n=g(t).$implicit,m=d();return _(m.setTheme(n))}),l(2),B(3,"titlecase"),f()()}if(i&2){let t=e.$implicit,r=d();a(),Z("active",r.currentTheme()===t),a(),L(" ",ee(3,3,t)," ")}}var F=class i{constructor(){j(()=>{this.setTheme(this.currentTheme())})}themes=["light","dark"];themeRepository=p(z);currentTheme=T(this.getCurrentTheme());getCurrentTheme(){return this.themeRepository.getTheme()}setTheme(e){this.currentTheme.set(e),this.themeRepository.setTheme(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=A({type:i,selectors:[["app-theme-switcher"]],decls:7,vars:0,consts:[[1,"dropdown","dropdown-end"],["tabindex","0",1,"btn","btn-ghost"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-6","h-6","mr-1"],["stroke-linecap","round","stroke-linejoin","round","d","M12 3v1.5M12 19.5V21M4.22 4.22l1.06 1.06M18.72 18.72l1.06 1.06M1.5 12H3m18 0h1.5M4.22 19.78l1.06-1.06M18.72 5.28l1.06-1.06M12 6a6 6 0 000 12a6 6 0 000-12z"],["tabindex","0",1,"dropdown-content","menu","bg-base-100","rounded-box","w-40","shadow"],[3,"click"]],template:function(t,r){t&1&&(u(0,"div",0)(1,"button",1),k(),u(2,"svg",2),M(3,"path",3),f()(),P(),u(4,"ul",4),V(5,de,4,5,"li",null,X),f()()),t&2&&(a(5),H(r.themes))},dependencies:[I,re],encapsulation:2,changeDetection:0})};var G=class i{http=p($);auth=p(y);baseUrl=`${C}/api`;readNotificationsKey="read_notifications";notificationCount=T(0);notifications=T([]);authHeaders(){let e=this.auth.currentUser()?.token||"";return new oe({Authorization:`Bearer ${e}`})}getPendingAdvisories(){return this.http.get(`${this.baseUrl}/programmer/advisories`,{headers:this.authHeaders()})}getMyAdvisories(){return this.http.get(`${this.baseUrl}/programmer/advisories/requester`,{headers:this.authHeaders()})}getReadNotifications(){let e=localStorage.getItem(this.readNotificationsKey);return e?JSON.parse(e):[]}markAsRead(e){let t=this.getReadNotifications();t.includes(e)||(t.push(e),localStorage.setItem(this.readNotificationsKey,JSON.stringify(t)))}loadNotifications(e,t){let r=this.getReadNotifications();t==="programmer"?this.getPendingAdvisories().subscribe({next:n=>{let m=n.filter(c=>c.status==="PENDIENTE").filter(c=>!r.includes(c.id));this.notificationCount.set(m.length),this.notifications.set(m.map(c=>({id:c.id,title:"Nueva solicitud de asesor\xEDa",message:`${c.requesterName} solicita una asesor\xEDa`,status:c.status,createdAt:c.scheduledAt})))}}):t==="user"&&this.getMyAdvisories().subscribe({next:n=>{let m=n.filter(c=>c.status!=="PENDIENTE").filter(c=>!r.includes(c.id));this.notificationCount.set(m.length),this.notifications.set(m.map(c=>({id:c.id,title:c.status==="APROBADA"?"Solicitud aprobada":"Solicitud rechazada",message:`Tu solicitud con ${c.programmerName} fue ${c.status==="APROBADA"?"aprobada":"rechazada"}`,status:c.status,createdAt:c.scheduledAt})))}})}static \u0275fac=function(t){return new(t||i)};static \u0275prov=D({token:i,factory:i.\u0275fac,providedIn:"root"})};var ue=(i,e)=>e.id;function pe(i,e){if(i&1&&(u(0,"span",2),l(1),f()),i&2){let t=d();a(),L(" ",t.notificationsService.notificationCount()," ")}}function fe(i,e){i&1&&(u(0,"p",9),l(1,"No hay notificaciones"),f())}function he(i,e){if(i&1){let t=b();u(0,"div",13)(1,"div",14)(2,"p",15),l(3),f(),u(4,"p",16),l(5),f(),u(6,"p",17),l(7),B(8,"date"),f()(),u(9,"button",18),N("click",function(){let n=g(t).$implicit,m=d(2);return _(m.markAsRead(n.id))}),k(),u(10,"svg",19),M(11,"path",20),f()()()}if(i&2){let t=e.$implicit;a(3),E(t.title),a(2),E(t.message),a(2),E(te(8,3,t.createdAt,"short"))}}function ge(i,e){if(i&1&&(u(0,"div",10),V(1,he,12,6,"div",13,ue),f()),i&2){let t=d();a(),H(t.notificationsService.notifications())}}var J=class i{authService=p(y);notificationsService=p(G);router=p(O);ngOnInit(){let e=this.authService.currentUser();e&&this.notificationsService.loadNotifications(e.email,e.role)}markAsRead(e){this.notificationsService.markAsRead(e);let r=this.notificationsService.notifications().filter(n=>n.id!==e);this.notificationsService.notifications.set(r),this.notificationsService.notificationCount.set(r.length)}goToAllNotifications(){this.router.navigate(["/notifications"])}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=A({type:i,selectors:[["app-notifications-bell"]],decls:15,vars:2,consts:[[1,"dropdown","dropdown-end"],["tabindex","0","type","button",1,"btn","btn-ghost","btn-circle","indicator"],[1,"indicator-item","badge","badge-primary","badge-sm"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"],["tabindex","0",1,"dropdown-content","z-[1]","card","card-compact","w-96","bg-base-100","shadow"],[1,"card-body","p-0","flex","flex-col","h-full"],[1,"p-4","border-b","border-base-300"],[1,"card-title","text-lg"],[1,"text-center","text-base-content/60","py-8"],[1,"max-h-96","overflow-y-auto"],[1,"border-t","border-base-300","p-3","mt-auto"],[1,"btn","btn-sm","btn-primary","w-full",3,"click"],[1,"mb-2","p-3","bg-base-200","hover:bg-base-300","transition","rounded","flex","justify-between","items-start","gap-2"],[1,"flex-1"],[1,"font-semibold","text-sm"],[1,"text-xs","text-base-content/70"],[1,"text-xs","text-base-content/50","mt-1"],["title","Marcar como le\xEDdo",1,"btn","btn-ghost","btn-xs","rounded-full","hover:bg-success/20",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4","text-success"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"]],template:function(t,r){t&1&&(u(0,"div",0)(1,"button",1),x(2,pe,2,1,"span",2),k(),u(3,"svg",3),M(4,"path",4),f()(),P(),u(5,"div",5)(6,"div",6)(7,"div",7)(8,"span",8),l(9,"Notificaciones"),f()(),x(10,fe,2,0,"p",9)(11,ge,3,0,"div",10),u(12,"div",11)(13,"button",12),N("click",function(){return r.goToAllNotifications()}),l(14," Ver todas las notificaciones "),f()()()()()),t&2&&(a(2),w(r.notificationsService.notificationCount()>0?2:-1),a(8),w(r.notificationsService.notifications().length===0?10:11))},dependencies:[I,ne],encapsulation:2})};function _e(i,e){if(i&1){let t=b();o(0,"li")(1,"a",25),S("click",function(){g(t);let n=d();return _(n.scrollToSection("home"))}),l(2,"Home"),s()()}}function ve(i,e){if(i&1){let t=b();o(0,"li")(1,"a",25),S("click",function(){g(t);let n=d();return _(n.scrollToSection("profiles"))}),l(2,"Profiles"),s()()}}function be(i,e){if(i&1){let t=b();o(0,"li")(1,"a",25),S("click",function(){g(t);let n=d();return _(n.scrollToSection("projects"))}),l(2,"Projects"),s()()}}function xe(i,e){i&1&&(o(0,"li")(1,"a",26),l(2,"Volver al Inicio"),s()())}function we(i,e){if(i&1&&(o(0,"li")(1,"a",27),l(2,"Mi Panel"),s()()),i&2){let t=d();a(),h("routerLink",t.getDashboardRoute())}}function Se(i,e){i&1&&(o(0,"li")(1,"a",28),v(2,"i",29),l(3," Agendar "),s()())}function Ee(i,e){if(i&1){let t=b();v(0,"app-notifications-bell"),o(1,"div",30)(2,"div",31)(3,"div",32),v(4,"img",33),s()(),o(5,"ul",34)(6,"li",35)(7,"span",36),l(8),s(),o(9,"span",37),l(10),s()(),o(11,"li")(12,"a",38),l(13,"My Profile"),s()(),v(14,"div",39),o(15,"li")(16,"a",40),S("click",function(){g(t);let n=d();return _(n.logout())}),l(17,"Sign Out"),s()()()()}if(i&2){let t,r,n,m=d();a(4),h("src",((t=m.userService.userProfile())==null?null:t.photoUrl)||"https://ui-avatars.com/api/?name="+(((t=m.userService.userProfile())==null?null:t.name)||"User")+"&background=0D9488&color=fff",Y),a(4),E((r=m.userService.userProfile())==null?null:r.name),a(2),E((n=m.userService.userProfile())==null?null:n.role)}}function Ce(i,e){i&1&&(o(0,"a",14),l(1," Login "),s())}function ye(i,e){if(i&1&&U(0,Ce,2,0,"a",41),i&2){let t=d();h("ngIf",t.router.url!=="/login")}}function ke(i,e){if(i&1&&(o(0,"div",19)(1,"div",42)(2,"div",43),v(3,"img",44),s()(),o(4,"div",45)(5,"p",46),l(6),s(),o(7,"p",47),l(8),s()()()),i&2){let t,r,n,m=d();a(3),h("src",((t=m.userService.userProfile())==null?null:t.photoUrl)||"https://ui-avatars.com/api/?name="+(((t=m.userService.userProfile())==null?null:t.name)||"User")+"&background=0D9488&color=fff",Y),a(3),E((r=m.userService.userProfile())==null?null:r.name),a(2),E((n=m.userService.userProfile())==null?null:n.role)}}function Te(i,e){if(i&1){let t=b();o(0,"li")(1,"a",48),S("click",function(){g(t);let n=d();return _(n.scrollToSection("home"))}),l(2,"Home"),s()()}}function De(i,e){if(i&1){let t=b();o(0,"li")(1,"a",48),S("click",function(){g(t);let n=d();return _(n.scrollToSection("profiles"))}),l(2,"Profiles"),s()()}}function Pe(i,e){if(i&1){let t=b();o(0,"li")(1,"a",48),S("click",function(){g(t);let n=d();return _(n.scrollToSection("projects"))}),l(2,"Projects"),s()()}}function Ae(i,e){i&1&&(o(0,"li")(1,"a",49),l(2,"Back to Home"),s()())}function Ie(i,e){if(i&1&&(o(0,"li")(1,"a",50),l(2,"Go to Dashboard"),s()()),i&2){let t=d();a(),h("routerLink",t.getDashboardRoute())}}function Me(i,e){i&1&&(o(0,"div",51),l(1,"Services"),s(),o(2,"li")(3,"a",52),v(4,"i",29),l(5," Book Advisory "),s()())}function Ne(i,e){if(i&1){let t=b();o(0,"li")(1,"a",53),S("click",function(){g(t);let n=d();return _(n.logout())}),l(2,"Sign Out"),s()()}}function Re(i,e){i&1&&(o(0,"li")(1,"a",54),l(2,"Sign In"),s()(),o(3,"li")(4,"a",55),l(5,"Register"),s()())}var me=class i{constructor(e){this.router=e}authService=p(y);userService=p(q);async logout(){try{await this.authService.logout().toPromise(),this.router.navigate(["/login"])}catch(e){console.error("Error al salir:",e)}}getDashboardRoute(){switch(this.userService.userProfile()?.role){case"admin":return"/admin";case"programmer":return"/programmer";default:return"/user"}}isHome(){return this.router.url==="/"||this.router.url.startsWith("/#")}scrollToSection(e){let t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth"})}static \u0275fac=function(t){return new(t||i)(Q(O))};static \u0275cmp=A({type:i,selectors:[["app-drawer"]],decls:43,vars:15,consts:[[1,"drawer"],["id","my-drawer-2","type","checkbox",1,"drawer-toggle"],[1,"drawer-content","flex","flex-col"],[1,"navbar","bg-base-300","w-full","px-4","shadow-sm"],[1,"flex-none","lg:hidden"],["for","my-drawer-2","aria-label","open sidebar",1,"btn","btn-square","btn-ghost"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"inline-block","h-6","w-6","stroke-current"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16M4 18h16"],[1,"mx-2","flex-1","px-2","font-bold","text-lg"],[1,"hidden","flex-none","lg:block"],[1,"menu","menu-horizontal","gap-2"],[4,"ngIf"],[1,"hidden","lg:block"],[1,"flex-none","gap-2","ml-2"],["routerLink","/login",1,"btn","btn-primary","btn-sm","rounded-full","px-5"],[1,"drawer-side","z-50"],["for","my-drawer-2","aria-label","close sidebar",1,"drawer-overlay"],[1,"bg-base-200","min-h-full","w-80","flex","flex-col"],[1,"menu","p-4","flex-1","overflow-y-auto"],[1,"flex","items-center","gap-3","mb-6","p-3","bg-base-100/50","rounded-xl","border","border-base-300"],[1,"divider","my-2"],[1,"p-4","border-t","border-base-300","bg-base-200","mt-auto"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-semibold","opacity-70"],[1,"dropdown","dropdown-top","dropdown-right"],[1,"btn","btn-ghost","btn-sm",3,"click"],["routerLink","/",1,"btn","btn-ghost","btn-sm"],[1,"btn","btn-ghost","btn-sm",3,"routerLink"],["routerLink","/user","routerLinkActive","bg-base-200",1,"btn","btn-ghost","btn-sm","text-secondary","font-bold"],[1,"fa-solid","fa-pen-to-square"],[1,"dropdown","dropdown-end"],["tabindex","0","role","button",1,"btn","btn-ghost","btn-circle","avatar","border","border-base-content/20"],[1,"w-9","rounded-full"],["alt","Avatar",3,"src"],["tabindex","0",1,"mt-3","z-[1]","p-2","shadow","menu","menu-sm","dropdown-content","bg-base-100","rounded-box","w-52","border","border-base-200"],[1,"menu-title","px-4","py-2","border-b","border-base-content/10","mb-2"],[1,"font-bold","text-base-content","block","truncate"],[1,"text-xs","font-normal","opacity-70","uppercase"],["routerLink","/profile"],[1,"divider","my-1"],[1,"text-error","font-semibold",3,"click"],["class","btn btn-primary btn-sm rounded-full px-5","routerLink","/login",4,"ngIf"],[1,"avatar"],[1,"w-10","rounded-full"],[3,"src"],[1,"overflow-hidden"],[1,"font-bold","text-sm","truncate"],[1,"text-xs","opacity-60","uppercase","truncate"],[3,"click"],["routerLink","/",1,"btn","btn-ghost"],[3,"routerLink"],[1,"divider","my-1","text-xs","opacity-50"],["routerLink","/user","routerLinkActive","active",1,"font-bold","text-secondary"],[1,"text-error",3,"click"],["routerLink","/login",1,"active"],["routerLink","/register"]],template:function(t,r){if(t&1&&(o(0,"div",0),v(1,"input",1),o(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),k(),o(6,"svg",6),v(7,"path",7),s()()(),P(),o(8,"div",8),l(9,"Dev-Solutions"),s(),o(10,"div",9)(11,"ul",10),U(12,_e,3,0,"li",11)(13,ve,3,0,"li",11)(14,be,3,0,"li",11)(15,xe,3,0,"li",11),x(16,we,3,1,"li"),x(17,Se,4,0,"li"),s()(),o(18,"div",12),v(19,"app-theme-switcher"),s(),o(20,"div",13),x(21,Ee,18,3)(22,ye,1,1,"a",14),s()()(),o(23,"div",15),v(24,"label",16),o(25,"aside",17)(26,"ul",18),x(27,ke,9,3,"div",19),U(28,Te,3,0,"li",11)(29,De,3,0,"li",11)(30,Pe,3,0,"li",11)(31,Ae,3,0,"li",11),x(32,Ie,3,1,"li"),x(33,Me,6,0),v(34,"div",20),x(35,Ne,3,0,"li")(36,Re,6,0),s(),o(37,"div",21)(38,"div",22)(39,"span",23),l(40,"Cambiar Tema:"),s(),o(41,"div",24),v(42,"app-theme-switcher"),s()()()()()()),t&2){let n,m,c,W;a(12),h("ngIf",r.isHome()),a(),h("ngIf",r.isHome()),a(),h("ngIf",r.isHome()),a(),h("ngIf",!r.isHome()),a(),w(((n=r.userService.userProfile())==null?null:n.role)==="admin"||((n=r.userService.userProfile())==null?null:n.role)==="programmer"?16:-1),a(),w(((m=r.userService.userProfile())==null?null:m.role)==="user"?17:-1),a(4),w(r.userService.userProfile()?21:22),a(6),w(r.userService.userProfile()?27:-1),a(),h("ngIf",r.isHome()),a(),h("ngIf",r.isHome()),a(),h("ngIf",r.isHome()),a(),h("ngIf",!r.isHome()),a(),w(((c=r.userService.userProfile())==null?null:c.role)==="admin"||((c=r.userService.userProfile())==null?null:c.role)==="programmer"?32:-1),a(),w(((W=r.userService.userProfile())==null?null:W.role)==="user"?33:-1),a(2),w(r.userService.userProfile()?35:36)}},dependencies:[ae,le,F,I,ie,J],encapsulation:2,changeDetection:0})};export{q as a,G as b,me as c};
